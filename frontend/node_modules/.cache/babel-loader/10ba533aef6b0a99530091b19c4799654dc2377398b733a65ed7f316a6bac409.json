{"ast":null,"code":"import axios from \"axios\";\n\n// --- CONFIGURATION ---\nconst BACKEND_URL = \"http://localhost:8001\";\n// ---\n\n/**\r\n * Performs a vector search by calling the backend's /knowledge_search endpoint.\r\n * Supports filtering by elevator ID.\r\n * @param {string} query - The user's question.\r\n * @param {string} elevatorId - The elevator ID (optional).\r\n */\nexport const searchKnowledge = async (query, elevatorId = \"\") => {\n  try {\n    var _res$data;\n    let url = `${BACKEND_URL}/knowledge_search?query=${encodeURIComponent(query)}&n_results=3`;\n    if (elevatorId && elevatorId.trim() !== \"\") {\n      url += `&elevator_id=${encodeURIComponent(elevatorId.trim())}`;\n    }\n    const res = await axios.get(url);\n    const results = ((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.results) || [];\n    if (results.length > 0) {\n      console.log(`ðŸ” Found ${results.length} results for Elevator ${elevatorId || \"All\"}.`);\n    }\n    return results;\n  } catch (error) {\n    console.error(\"âŒ Error fetching knowledge:\", error);\n    return [{\n      problem: \"Error\",\n      cause: \"Could not reach knowledge base or backend service.\",\n      steps: error.message,\n      distance: 1.0\n    }];\n  }\n};\n\n/**\r\n * Stores the chat log entry in the backend database.\r\n * Includes the elevator_id field for tracking.\r\n */\nexport async function persistLog(expertId, userQuery, searchResults, elevatorId = \"\") {\n  if (!expertId) return false;\n  let aiResponseText = \"No relevant steps found.\";\n  if (searchResults && searchResults.length > 0) {\n    aiResponseText = searchResults.map((r, i) => {\n      const distance = parseFloat(r.distance);\n      const distanceText = !isNaN(distance) ? distance.toFixed(4) : \"N/A\";\n      return `--- Match ${i + 1} (Distance: ${distanceText}) ---\\nProblem: ${r.problem}\\nCause: ${r.cause}\\nSteps: ${r.steps}`;\n    }).join(\"\\n\\n\");\n  }\n  try {\n    const logId = crypto.randomUUID();\n    const logData = {\n      expert_id: expertId,\n      elevator_id: elevatorId || \"Unspecified\",\n      user_query: userQuery,\n      ai_response: aiResponseText,\n      status: \"completed\",\n      timestamp: new Date().toISOString(),\n      log_id: logId\n    };\n    await axios.post(`${BACKEND_URL}/store_log`, logData);\n    console.log(`ðŸŸ¢ Log stored for Elevator ${elevatorId || \"Unspecified\"}`);\n    return true;\n  } catch (err) {\n    console.error(\"Error saving log:\", err.response ? err.response.data : err.message);\n    return false;\n  }\n}","map":{"version":3,"names":["axios","BACKEND_URL","searchKnowledge","query","elevatorId","_res$data","url","encodeURIComponent","trim","res","get","results","data","length","console","log","error","problem","cause","steps","message","distance","persistLog","expertId","userQuery","searchResults","aiResponseText","map","r","i","parseFloat","distanceText","isNaN","toFixed","join","logId","crypto","randomUUID","logData","expert_id","elevator_id","user_query","ai_response","status","timestamp","Date","toISOString","log_id","post","err","response"],"sources":["C:/Users/Hari/OneDrive/Desktop/elevator_project/frontend/src/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\n// --- CONFIGURATION ---\r\nconst BACKEND_URL = \"http://localhost:8001\"; \r\n// ---\r\n\r\n/**\r\n * Performs a vector search by calling the backend's /knowledge_search endpoint.\r\n * Supports filtering by elevator ID.\r\n * @param {string} query - The user's question.\r\n * @param {string} elevatorId - The elevator ID (optional).\r\n */\r\nexport const searchKnowledge = async (query, elevatorId = \"\") => {\r\n    try {\r\n        let url = `${BACKEND_URL}/knowledge_search?query=${encodeURIComponent(query)}&n_results=3`;\r\n        if (elevatorId && elevatorId.trim() !== \"\") {\r\n            url += `&elevator_id=${encodeURIComponent(elevatorId.trim())}`;\r\n        }\r\n\r\n        const res = await axios.get(url);\r\n        const results = res.data?.results || [];\r\n        \r\n        if (results.length > 0) {\r\n            console.log(`ðŸ” Found ${results.length} results for Elevator ${elevatorId || \"All\"}.`);\r\n        }\r\n        return results; \r\n    } catch (error) {\r\n        console.error(\"âŒ Error fetching knowledge:\", error);\r\n        return [{\r\n            problem: \"Error\",\r\n            cause: \"Could not reach knowledge base or backend service.\",\r\n            steps: error.message,\r\n            distance: 1.0\r\n        }]; \r\n    }\r\n};\r\n\r\n/**\r\n * Stores the chat log entry in the backend database.\r\n * Includes the elevator_id field for tracking.\r\n */\r\nexport async function persistLog(expertId, userQuery, searchResults, elevatorId = \"\") {\r\n    if (!expertId) return false; \r\n\r\n    let aiResponseText = \"No relevant steps found.\";\r\n    if (searchResults && searchResults.length > 0) {\r\n        aiResponseText = searchResults.map((r, i) => {\r\n            const distance = parseFloat(r.distance);\r\n            const distanceText = !isNaN(distance) ? distance.toFixed(4) : \"N/A\";\r\n            return `--- Match ${i + 1} (Distance: ${distanceText}) ---\\nProblem: ${r.problem}\\nCause: ${r.cause}\\nSteps: ${r.steps}`;\r\n        }).join(\"\\n\\n\");\r\n    }\r\n    \r\n    try {\r\n        const logId = crypto.randomUUID(); \r\n        const logData = {\r\n            expert_id: expertId,\r\n            elevator_id: elevatorId || \"Unspecified\",\r\n            user_query: userQuery,\r\n            ai_response: aiResponseText,\r\n            status: \"completed\",\r\n            timestamp: new Date().toISOString(),\r\n            log_id: logId,\r\n        };\r\n        \r\n        await axios.post(`${BACKEND_URL}/store_log`, logData);\r\n        console.log(`ðŸŸ¢ Log stored for Elevator ${elevatorId || \"Unspecified\"}`);\r\n        return true;\r\n    } catch (err) {\r\n        console.error(\"Error saving log:\", err.response ? err.response.data : err.message);\r\n        return false;\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}