{"ast":null,"code":"import axios from \"axios\";\nconst BACKEND_URL = \"http://127.0.0.1:8001\";\n\n/**\r\n * AI-powered vector + semantic search\r\n */\nexport const searchKnowledge = async (query, elevatorId = \"\") => {\n  try {\n    var _res$data;\n    const url = `${BACKEND_URL}/knowledge_search?query=${encodeURIComponent(query)}${elevatorId ? `&elevator_id=${encodeURIComponent(elevatorId)}` : \"\"}`;\n    const res = await axios.get(url);\n    const results = ((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.results) || [];\n    console.log(\"AI retrieval results:\", results);\n    return results;\n  } catch (error) {\n    console.error(\"❌ Error fetching knowledge:\", error);\n    return [{\n      problem: \"Error\",\n      cause: \"Unable to reach backend or model.\",\n      steps: error.message,\n      distance: 1.0\n    }];\n  }\n};\n\n/**\r\n * Logs user queries and AI results to the backend database\r\n * Used by ChatBox.js after each query.\r\n */\nexport async function persistLog(expertId, userQuery, searchResults) {\n  if (!expertId) return false;\n  let aiResponseText = \"No relevant results found.\";\n  if (searchResults && searchResults.length > 0) {\n    aiResponseText = searchResults.map((r, i) => {\n      const dist = parseFloat(r.distance);\n      const distText = !isNaN(dist) ? dist.toFixed(4) : \"N/A\";\n      return `--- Match ${i + 1} (Distance: ${distText}) ---\\nProblem: ${r.problem}\\nCause: ${r.cause}\\nSteps: ${r.steps}`;\n    }).join(\"\\n\\n\");\n  }\n  try {\n    const logData = {\n      expert_id: expertId,\n      user_query: userQuery,\n      ai_response: aiResponseText,\n      timestamp: new Date().toISOString(),\n      status: \"completed\"\n    };\n    await axios.post(`${BACKEND_URL}/store_log`, logData);\n    console.log(\"✅ Log successfully stored.\");\n    return true;\n  } catch (err) {\n    console.error(\"❌ Error saving log:\", err.message);\n    return false;\n  }\n}","map":{"version":3,"names":["axios","BACKEND_URL","searchKnowledge","query","elevatorId","_res$data","url","encodeURIComponent","res","get","results","data","console","log","error","problem","cause","steps","message","distance","persistLog","expertId","userQuery","searchResults","aiResponseText","length","map","r","i","dist","parseFloat","distText","isNaN","toFixed","join","logData","expert_id","user_query","ai_response","timestamp","Date","toISOString","status","post","err"],"sources":["C:/Users/Hari/OneDrive/Desktop/elevator_project/frontend/src/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst BACKEND_URL = \"http://127.0.0.1:8001\";\r\n\r\n/**\r\n * AI-powered vector + semantic search\r\n */\r\nexport const searchKnowledge = async (query, elevatorId = \"\") => {\r\n    try {\r\n        const url = `${BACKEND_URL}/knowledge_search?query=${encodeURIComponent(query)}${\r\n            elevatorId ? `&elevator_id=${encodeURIComponent(elevatorId)}` : \"\"\r\n        }`;\r\n\r\n        const res = await axios.get(url);\r\n        const results = res.data?.results || [];\r\n        console.log(\"AI retrieval results:\", results);\r\n        return results;\r\n    } catch (error) {\r\n        console.error(\"❌ Error fetching knowledge:\", error);\r\n        return [\r\n            {\r\n                problem: \"Error\",\r\n                cause: \"Unable to reach backend or model.\",\r\n                steps: error.message,\r\n                distance: 1.0\r\n            },\r\n        ];\r\n    }\r\n};\r\n\r\n/**\r\n * Logs user queries and AI results to the backend database\r\n * Used by ChatBox.js after each query.\r\n */\r\nexport async function persistLog(expertId, userQuery, searchResults) {\r\n    if (!expertId) return false;\r\n\r\n    let aiResponseText = \"No relevant results found.\";\r\n    if (searchResults && searchResults.length > 0) {\r\n        aiResponseText = searchResults\r\n            .map((r, i) => {\r\n                const dist = parseFloat(r.distance);\r\n                const distText = !isNaN(dist) ? dist.toFixed(4) : \"N/A\";\r\n                return `--- Match ${i + 1} (Distance: ${distText}) ---\\nProblem: ${\r\n                    r.problem\r\n                }\\nCause: ${r.cause}\\nSteps: ${r.steps}`;\r\n            })\r\n            .join(\"\\n\\n\");\r\n    }\r\n\r\n    try {\r\n        const logData = {\r\n            expert_id: expertId,\r\n            user_query: userQuery,\r\n            ai_response: aiResponseText,\r\n            timestamp: new Date().toISOString(),\r\n            status: \"completed\",\r\n        };\r\n\r\n        await axios.post(`${BACKEND_URL}/store_log`, logData);\r\n        console.log(\"✅ Log successfully stored.\");\r\n        return true;\r\n    } catch (err) {\r\n        console.error(\"❌ Error saving log:\", err.message);\r\n        return false;\r\n    }\r\n}\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,WAAW,GAAG,uBAAuB;;AAE3C;AACA;AACA;AACA,OAAO,MAAMC,eAAe,GAAG,MAAAA,CAAOC,KAAK,EAAEC,UAAU,GAAG,EAAE,KAAK;EAC7D,IAAI;IAAA,IAAAC,SAAA;IACA,MAAMC,GAAG,GAAG,GAAGL,WAAW,2BAA2BM,kBAAkB,CAACJ,KAAK,CAAC,GAC1EC,UAAU,GAAG,gBAAgBG,kBAAkB,CAACH,UAAU,CAAC,EAAE,GAAG,EAAE,EACpE;IAEF,MAAMI,GAAG,GAAG,MAAMR,KAAK,CAACS,GAAG,CAACH,GAAG,CAAC;IAChC,MAAMI,OAAO,GAAG,EAAAL,SAAA,GAAAG,GAAG,CAACG,IAAI,cAAAN,SAAA,uBAARA,SAAA,CAAUK,OAAO,KAAI,EAAE;IACvCE,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEH,OAAO,CAAC;IAC7C,OAAOA,OAAO;EAClB,CAAC,CAAC,OAAOI,KAAK,EAAE;IACZF,OAAO,CAACE,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;IACnD,OAAO,CACH;MACIC,OAAO,EAAE,OAAO;MAChBC,KAAK,EAAE,mCAAmC;MAC1CC,KAAK,EAAEH,KAAK,CAACI,OAAO;MACpBC,QAAQ,EAAE;IACd,CAAC,CACJ;EACL;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA,OAAO,eAAeC,UAAUA,CAACC,QAAQ,EAAEC,SAAS,EAAEC,aAAa,EAAE;EACjE,IAAI,CAACF,QAAQ,EAAE,OAAO,KAAK;EAE3B,IAAIG,cAAc,GAAG,4BAA4B;EACjD,IAAID,aAAa,IAAIA,aAAa,CAACE,MAAM,GAAG,CAAC,EAAE;IAC3CD,cAAc,GAAGD,aAAa,CACzBG,GAAG,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;MACX,MAAMC,IAAI,GAAGC,UAAU,CAACH,CAAC,CAACR,QAAQ,CAAC;MACnC,MAAMY,QAAQ,GAAG,CAACC,KAAK,CAACH,IAAI,CAAC,GAAGA,IAAI,CAACI,OAAO,CAAC,CAAC,CAAC,GAAG,KAAK;MACvD,OAAO,aAAaL,CAAC,GAAG,CAAC,eAAeG,QAAQ,mBAC5CJ,CAAC,CAACZ,OAAO,YACDY,CAAC,CAACX,KAAK,YAAYW,CAAC,CAACV,KAAK,EAAE;IAC5C,CAAC,CAAC,CACDiB,IAAI,CAAC,MAAM,CAAC;EACrB;EAEA,IAAI;IACA,MAAMC,OAAO,GAAG;MACZC,SAAS,EAAEf,QAAQ;MACnBgB,UAAU,EAAEf,SAAS;MACrBgB,WAAW,EAAEd,cAAc;MAC3Be,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MACnCC,MAAM,EAAE;IACZ,CAAC;IAED,MAAM1C,KAAK,CAAC2C,IAAI,CAAC,GAAG1C,WAAW,YAAY,EAAEkC,OAAO,CAAC;IACrDvB,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;IACzC,OAAO,IAAI;EACf,CAAC,CAAC,OAAO+B,GAAG,EAAE;IACVhC,OAAO,CAACE,KAAK,CAAC,qBAAqB,EAAE8B,GAAG,CAAC1B,OAAO,CAAC;IACjD,OAAO,KAAK;EAChB;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}