{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hari\\\\OneDrive\\\\Desktop\\\\elevator_project\\\\frontend\\\\src\\\\ChatPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { useAuth } from './authontext';\nimport { useNavigate } from 'react-router-dom';\n\n// --- CONFIGURATION ---\n// Unified Backend URL\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst BACKEND_URL = \"http://localhost:8001\";\n// Gemini API Key (leave empty, Canvas provides it at runtime)\nconst GEMINI_API_KEY = \"\";\nconst GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${GEMINI_API_KEY}`;\n// ---\n\n// Helper function to handle exponential backoff for API calls\nconst fetchWithBackoff = async (url, options, maxRetries = 5) => {\n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      const response = await fetch(url, options);\n      if (!response.ok) {\n        // If it's a 4xx or 5xx error, throw it immediately\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return response;\n    } catch (error) {\n      console.error(`Attempt ${attempt + 1} failed: ${error.message}`);\n      if (attempt === maxRetries - 1) throw error;\n\n      // Calculate delay: 2^attempt seconds (1, 2, 4, 8, 16)\n      const delay = Math.pow(2, attempt) * 1000;\n      await new Promise(resolve => setTimeout(resolve, delay));\n    }\n  }\n};\n\n// Component to handle chat and log retrieval\nexport default function ChatPage() {\n  _s();\n  const {\n    user,\n    logout\n  } = useAuth();\n  const navigate = useNavigate();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [isThinking, setIsThinking] = useState(false);\n  const [logStatus, setLogStatus] = useState(\"Not saved\");\n  const messagesEndRef = useRef(null);\n  const expertId = user === null || user === void 0 ? void 0 : user.id;\n\n  // Scroll to bottom whenever messages update\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [messages]);\n\n  // Redirect if not logged in\n  useEffect(() => {\n    if (!user || !user.id || user.role !== 'technician') {\n      navigate('/login');\n    }\n  }, [user, navigate]);\n\n  // --- RAG IMPLEMENTATION: Fetch relevant expert knowledge ---\n  const fetchKnowledge = async query => {\n    try {\n      var _res$data;\n      const res = await axios.get(`${BACKEND_URL}/knowledge_search?query=${encodeURIComponent(query)}&n_results=3`);\n\n      // The backend returns an array of relevant document strings\n      const relevantDocs = ((_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.results) || [];\n      if (relevantDocs.length > 0) {\n        console.log(`ðŸ” Found ${relevantDocs.length} knowledge items for RAG.`);\n        // Format the documents into a single string for the prompt\n        return relevantDocs.map((doc, index) => `Context ${index + 1}: ${doc}`).join(\"\\n---\\n\");\n      }\n      return null; // Return null if no relevant context is found\n    } catch (error) {\n      console.error(\"âŒ Error fetching knowledge for RAG:\", error);\n      return null;\n    }\n  };\n  // -------------------------------------------------------------\n\n  // --- Gemini API Call ---\n  const getGeminiResponse = async (userQuery, conversationHistory) => {\n    const historyText = conversationHistory.map(msg => msg.role === 'user' ? `User: ${msg.text}` : `AI: ${msg.text}`).join(\"\\n\");\n\n    // STEP 1: RAG - Fetch relevant knowledge\n    const knowledgeContext = await fetchKnowledge(userQuery);\n    let systemPrompt = \"You are a helpful and detailed technical support expert. Provide concise, step-by-step solutions.\";\n\n    // Enhance the system prompt with retrieved knowledge\n    if (knowledgeContext) {\n      systemPrompt += `\\n\\n--- CRITICAL KNOWLEDGE BASE CONTEXT ---\\n${knowledgeContext}\\n--- END OF CONTEXT ---\\n\n            \\nBased on the user's current query and the provided knowledge base context above (if relevant), provide the solution. Only use the context if it directly answers the user's question.`;\n    }\n    const payload = {\n      contents: [{\n        role: \"user\",\n        parts: [{\n          text: userQuery\n        }]\n      }],\n      systemInstruction: {\n        parts: [{\n          text: systemPrompt\n        }]\n      }\n    };\n    try {\n      var _result$candidates, _result$candidates$, _result$candidates$$c, _result$candidates$$c2, _result$candidates$$c3;\n      const response = await fetchWithBackoff(GEMINI_API_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(payload)\n      });\n      const result = await response.json();\n      const text = (result === null || result === void 0 ? void 0 : (_result$candidates = result.candidates) === null || _result$candidates === void 0 ? void 0 : (_result$candidates$ = _result$candidates[0]) === null || _result$candidates$ === void 0 ? void 0 : (_result$candidates$$c = _result$candidates$.content) === null || _result$candidates$$c === void 0 ? void 0 : (_result$candidates$$c2 = _result$candidates$$c.parts) === null || _result$candidates$$c2 === void 0 ? void 0 : (_result$candidates$$c3 = _result$candidates$$c2[0]) === null || _result$candidates$$c3 === void 0 ? void 0 : _result$candidates$$c3.text) || \"Sorry, I couldn't generate a response.\";\n      return text;\n    } catch (error) {\n      console.error(\"Gemini API call failed:\", error);\n      return \"The AI service is currently unavailable. Please try again later.\";\n    }\n  };\n\n  // --- Log Storage ---\n  const storeLog = async logData => {\n    setLogStatus(\"Saving...\");\n    try {\n      // Note: The /api/store_log endpoint is for technician/chat history\n      await axios.post(`${BACKEND_URL}/api/store_log`, logData);\n      setLogStatus(\"Saved\");\n    } catch (error) {\n      console.error(\"Error storing chat log:\", error);\n      setLogStatus(\"Error saving log.\");\n    }\n  };\n\n  // --- Main Send Message Handler ---\n  const handleSend = async e => {\n    e.preventDefault();\n    const userQuery = input.trim();\n    if (!userQuery || isThinking || !expertId) return;\n    setInput('');\n    setIsThinking(true);\n    setLogStatus(\"Not saved\");\n    const newMessages = [...messages, {\n      role: 'user',\n      text: userQuery\n    }];\n    setMessages(newMessages);\n\n    // Get AI Response (which now includes RAG)\n    const aiResponseText = await getGeminiResponse(userQuery, messages);\n    const finalMessages = [...newMessages, {\n      role: 'ai',\n      text: aiResponseText\n    }];\n    setMessages(finalMessages);\n    setIsThinking(false);\n\n    // Store the new conversation turn as a log\n    const logEntry = {\n      expert_id: expertId,\n      // This should be the TECHNICIAN's ID (which we called expertId in AuthContext for simplicity)\n      user_query: userQuery,\n      ai_response: aiResponseText,\n      status: \"Completed\",\n      log_id: `tech_log_${Date.now()}` // Unique ID for ChromaDB\n    };\n    storeLog(logEntry);\n  };\n  const handleSignOut = () => {\n    logout();\n    navigate('/');\n  };\n\n  // Fallback if not authenticated\n  if (!user || !user.id) {\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title\",\n        children: [\"\\uD83D\\uDCAC Technician Chat Support (ID: \", expertId, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          gap: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: '0.8em',\n            color: '#666'\n          },\n          children: [\"Log Status: \", logStatus]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn outline\",\n          onClick: handleSignOut,\n          children: \"Sign out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"20px\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        height: 'calc(100vh - 80px)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flexGrow: 1,\n          overflowY: 'auto',\n          paddingRight: '15px'\n        },\n        children: [messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: 'center',\n            color: '#666',\n            marginTop: '50px'\n          },\n          children: \"Hello! How can I assist you with your technical issues today?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 25\n        }, this) : messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '15px',\n            display: 'flex',\n            justifyContent: msg.role === 'user' ? 'flex-end' : 'flex-start'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              maxWidth: '70%',\n              padding: '10px 15px',\n              borderRadius: '15px',\n              backgroundColor: msg.role === 'user' ? '#007bff' : '#f1f1f1',\n              color: msg.role === 'user' ? 'white' : 'black',\n              wordBreak: 'break-word',\n              boxShadow: '0 1px 3px rgba(0,0,0,0.1)'\n            },\n            children: msg.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 33\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 29\n        }, this)), isThinking && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'flex-start',\n            marginBottom: '15px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              maxWidth: '70%',\n              padding: '10px 15px',\n              borderRadius: '15px',\n              backgroundColor: '#e9ecef',\n              color: '#6c757d'\n            },\n            children: \"Thinking...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSend,\n        style: {\n          display: 'flex',\n          marginTop: '20px',\n          borderTop: '1px solid #ddd',\n          paddingTop: '10px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: input,\n          onChange: e => setInput(e.target.value),\n          placeholder: \"Type your technical query...\",\n          disabled: isThinking,\n          style: {\n            flexGrow: 1,\n            padding: '10px',\n            border: '1px solid #ccc',\n            borderRadius: '4px 0 0 4px',\n            fontSize: '1em'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: !input.trim() || isThinking,\n          className: \"btn\",\n          style: {\n            borderRadius: '0 4px 4px 0',\n            minWidth: '80px'\n          },\n          children: isThinking ? 'Sending...' : 'Send'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n_s(ChatPage, \"RnGJ/wMmn5CqypNtnVt0yjvwwFI=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = ChatPage;\nvar _c;\n$RefreshReg$(_c, \"ChatPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","useAuth","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","BACKEND_URL","GEMINI_API_KEY","GEMINI_API_URL","fetchWithBackoff","url","options","maxRetries","attempt","response","fetch","ok","Error","status","error","console","message","delay","Math","pow","Promise","resolve","setTimeout","ChatPage","_s","user","logout","navigate","messages","setMessages","input","setInput","isThinking","setIsThinking","logStatus","setLogStatus","messagesEndRef","expertId","id","_messagesEndRef$curre","current","scrollIntoView","behavior","role","fetchKnowledge","query","_res$data","res","get","encodeURIComponent","relevantDocs","data","results","length","log","map","doc","index","join","getGeminiResponse","userQuery","conversationHistory","historyText","msg","text","knowledgeContext","systemPrompt","payload","contents","parts","systemInstruction","_result$candidates","_result$candidates$","_result$candidates$$c","_result$candidates$$c2","_result$candidates$$c3","method","headers","body","JSON","stringify","result","json","candidates","content","storeLog","logData","post","handleSend","e","preventDefault","trim","newMessages","aiResponseText","finalMessages","logEntry","expert_id","user_query","ai_response","log_id","Date","now","handleSignOut","children","className","fileName","_jsxFileName","lineNumber","columnNumber","style","display","gap","fontSize","color","onClick","padding","flexDirection","height","flexGrow","overflowY","paddingRight","textAlign","marginTop","marginBottom","justifyContent","maxWidth","borderRadius","backgroundColor","wordBreak","boxShadow","ref","onSubmit","borderTop","paddingTop","type","value","onChange","target","placeholder","disabled","border","minWidth","_c","$RefreshReg$"],"sources":["C:/Users/Hari/OneDrive/Desktop/elevator_project/frontend/src/ChatPage.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport { useAuth } from './authontext';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\n// --- CONFIGURATION ---\r\n// Unified Backend URL\r\nconst BACKEND_URL = \"http://localhost:8001\"; \r\n// Gemini API Key (leave empty, Canvas provides it at runtime)\r\nconst GEMINI_API_KEY = \"\"; \r\nconst GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${GEMINI_API_KEY}`;\r\n// ---\r\n\r\n// Helper function to handle exponential backoff for API calls\r\nconst fetchWithBackoff = async (url, options, maxRetries = 5) => {\r\n    for (let attempt = 0; attempt < maxRetries; attempt++) {\r\n        try {\r\n            const response = await fetch(url, options);\r\n            if (!response.ok) {\r\n                // If it's a 4xx or 5xx error, throw it immediately\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n            return response;\r\n        } catch (error) {\r\n            console.error(`Attempt ${attempt + 1} failed: ${error.message}`);\r\n            if (attempt === maxRetries - 1) throw error; \r\n\r\n            // Calculate delay: 2^attempt seconds (1, 2, 4, 8, 16)\r\n            const delay = Math.pow(2, attempt) * 1000;\r\n            await new Promise(resolve => setTimeout(resolve, delay));\r\n        }\r\n    }\r\n};\r\n\r\n// Component to handle chat and log retrieval\r\nexport default function ChatPage() {\r\n    const { user, logout } = useAuth();\r\n    const navigate = useNavigate();\r\n    const [messages, setMessages] = useState([]);\r\n    const [input, setInput] = useState('');\r\n    const [isThinking, setIsThinking] = useState(false);\r\n    const [logStatus, setLogStatus] = useState(\"Not saved\");\r\n    const messagesEndRef = useRef(null);\r\n\r\n    const expertId = user?.id;\r\n\r\n    // Scroll to bottom whenever messages update\r\n    useEffect(() => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    }, [messages]);\r\n\r\n    // Redirect if not logged in\r\n    useEffect(() => {\r\n        if (!user || !user.id || user.role !== 'technician') {\r\n            navigate('/login');\r\n        }\r\n    }, [user, navigate]);\r\n\r\n\r\n    // --- RAG IMPLEMENTATION: Fetch relevant expert knowledge ---\r\n    const fetchKnowledge = async (query) => {\r\n        try {\r\n            const res = await axios.get(`${BACKEND_URL}/knowledge_search?query=${encodeURIComponent(query)}&n_results=3`);\r\n            \r\n            // The backend returns an array of relevant document strings\r\n            const relevantDocs = res.data?.results || [];\r\n            \r\n            if (relevantDocs.length > 0) {\r\n                console.log(`ðŸ” Found ${relevantDocs.length} knowledge items for RAG.`);\r\n                // Format the documents into a single string for the prompt\r\n                return relevantDocs.map((doc, index) => `Context ${index + 1}: ${doc}`).join(\"\\n---\\n\");\r\n            }\r\n            return null; // Return null if no relevant context is found\r\n        } catch (error) {\r\n            console.error(\"âŒ Error fetching knowledge for RAG:\", error);\r\n            return null;\r\n        }\r\n    };\r\n    // -------------------------------------------------------------\r\n\r\n    // --- Gemini API Call ---\r\n    const getGeminiResponse = async (userQuery, conversationHistory) => {\r\n        const historyText = conversationHistory.map(msg => \r\n            msg.role === 'user' ? `User: ${msg.text}` : `AI: ${msg.text}`\r\n        ).join(\"\\n\");\r\n\r\n        // STEP 1: RAG - Fetch relevant knowledge\r\n        const knowledgeContext = await fetchKnowledge(userQuery);\r\n        \r\n        let systemPrompt = \"You are a helpful and detailed technical support expert. Provide concise, step-by-step solutions.\";\r\n        \r\n        // Enhance the system prompt with retrieved knowledge\r\n        if (knowledgeContext) {\r\n            systemPrompt += `\\n\\n--- CRITICAL KNOWLEDGE BASE CONTEXT ---\\n${knowledgeContext}\\n--- END OF CONTEXT ---\\n\r\n            \\nBased on the user's current query and the provided knowledge base context above (if relevant), provide the solution. Only use the context if it directly answers the user's question.`;\r\n        }\r\n\r\n        const payload = {\r\n            contents: [\r\n                { role: \"user\", parts: [{ text: userQuery }] }\r\n            ],\r\n            systemInstruction: {\r\n                parts: [{ text: systemPrompt }]\r\n            },\r\n        };\r\n\r\n        try {\r\n            const response = await fetchWithBackoff(GEMINI_API_URL, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(payload)\r\n            });\r\n            \r\n            const result = await response.json();\r\n            const text = result?.candidates?.[0]?.content?.parts?.[0]?.text || \"Sorry, I couldn't generate a response.\";\r\n            return text;\r\n\r\n        } catch (error) {\r\n            console.error(\"Gemini API call failed:\", error);\r\n            return \"The AI service is currently unavailable. Please try again later.\";\r\n        }\r\n    };\r\n\r\n    // --- Log Storage ---\r\n    const storeLog = async (logData) => {\r\n        setLogStatus(\"Saving...\");\r\n        try {\r\n            // Note: The /api/store_log endpoint is for technician/chat history\r\n            await axios.post(`${BACKEND_URL}/api/store_log`, logData);\r\n            setLogStatus(\"Saved\");\r\n        } catch (error) {\r\n            console.error(\"Error storing chat log:\", error);\r\n            setLogStatus(\"Error saving log.\");\r\n        }\r\n    };\r\n\r\n    // --- Main Send Message Handler ---\r\n    const handleSend = async (e) => {\r\n        e.preventDefault();\r\n        const userQuery = input.trim();\r\n        if (!userQuery || isThinking || !expertId) return;\r\n\r\n        setInput('');\r\n        setIsThinking(true);\r\n        setLogStatus(\"Not saved\");\r\n\r\n        const newMessages = [...messages, { role: 'user', text: userQuery }];\r\n        setMessages(newMessages);\r\n\r\n        // Get AI Response (which now includes RAG)\r\n        const aiResponseText = await getGeminiResponse(userQuery, messages);\r\n        \r\n        const finalMessages = [...newMessages, { role: 'ai', text: aiResponseText }];\r\n        setMessages(finalMessages);\r\n        setIsThinking(false);\r\n\r\n        // Store the new conversation turn as a log\r\n        const logEntry = {\r\n            expert_id: expertId, // This should be the TECHNICIAN's ID (which we called expertId in AuthContext for simplicity)\r\n            user_query: userQuery,\r\n            ai_response: aiResponseText,\r\n            status: \"Completed\",\r\n            log_id: `tech_log_${Date.now()}` // Unique ID for ChromaDB\r\n        };\r\n        storeLog(logEntry);\r\n    };\r\n\r\n    const handleSignOut = () => {\r\n        logout();\r\n        navigate('/');\r\n    }\r\n    \r\n    // Fallback if not authenticated\r\n    if (!user || !user.id) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className=\"header\">\r\n                <div className=\"title\">ðŸ’¬ Technician Chat Support (ID: {expertId})</div>\r\n                <div style={{ display: \"flex\", gap: 12 }}>\r\n                    <span style={{ fontSize: '0.8em', color: '#666' }}>Log Status: {logStatus}</span>\r\n                    <button className=\"btn outline\" onClick={handleSignOut}>Sign out</button>\r\n                </div>\r\n            </div>\r\n            <div style={{ padding: \"20px\", display: \"flex\", flexDirection: \"column\", height: 'calc(100vh - 80px)' }}>\r\n                {/* Chat Display Area */}\r\n                <div style={{ flexGrow: 1, overflowY: 'auto', paddingRight: '15px' }}>\r\n                    {messages.length === 0 ? (\r\n                        <p style={{ textAlign: 'center', color: '#666', marginTop: '50px' }}>\r\n                            Hello! How can I assist you with your technical issues today?\r\n                        </p>\r\n                    ) : (\r\n                        messages.map((msg, index) => (\r\n                            <div key={index} style={{\r\n                                marginBottom: '15px',\r\n                                display: 'flex',\r\n                                justifyContent: msg.role === 'user' ? 'flex-end' : 'flex-start'\r\n                            }}>\r\n                                <div style={{\r\n                                    maxWidth: '70%',\r\n                                    padding: '10px 15px',\r\n                                    borderRadius: '15px',\r\n                                    backgroundColor: msg.role === 'user' ? '#007bff' : '#f1f1f1',\r\n                                    color: msg.role === 'user' ? 'white' : 'black',\r\n                                    wordBreak: 'break-word',\r\n                                    boxShadow: '0 1px 3px rgba(0,0,0,0.1)'\r\n                                }}>\r\n                                    {msg.text}\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    )}\r\n                    {isThinking && (\r\n                        <div style={{ display: 'flex', justifyContent: 'flex-start', marginBottom: '15px' }}>\r\n                            <div style={{\r\n                                maxWidth: '70%',\r\n                                padding: '10px 15px',\r\n                                borderRadius: '15px',\r\n                                backgroundColor: '#e9ecef',\r\n                                color: '#6c757d'\r\n                            }}>\r\n                                Thinking...\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    <div ref={messagesEndRef} />\r\n                </div>\r\n                \r\n                {/* Input Area */}\r\n                <form onSubmit={handleSend} style={{ display: 'flex', marginTop: '20px', borderTop: '1px solid #ddd', paddingTop: '10px' }}>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={input}\r\n                        onChange={(e) => setInput(e.target.value)}\r\n                        placeholder=\"Type your technical query...\"\r\n                        disabled={isThinking}\r\n                        style={{ flexGrow: 1, padding: '10px', border: '1px solid #ccc', borderRadius: '4px 0 0 4px', fontSize: '1em' }}\r\n                    />\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={!input.trim() || isThinking}\r\n                        className=\"btn\"\r\n                        style={{ borderRadius: '0 4px 4px 0', minWidth: '80px' }}\r\n                    >\r\n                        {isThinking ? 'Sending...' : 'Send'}\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}